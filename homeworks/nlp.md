# Задание 3. NLP
## Задача 1 5 баллов
-Напишите токенайзенр на основе BPE, используя претокенизацию и специальные токены. Можете использовать паттерны претокенизации открытых моделей, указав источник. 
- Обучите свой токенизатор на своем корпусе, токенизируйте тексты, не совпадающие с использованным для обучения. 
- Определите коэффициент сжатия (число токенов к количеству байт/символов), среднее количество токенов на слово, среднее количество токенов на слово для топ 10% частотных слов. Ответьте на вопрос, отличается ли эффективность для разных доменов?
- Постройте кривую: размер словаря vs compression ratio
- Определите, какая часть токенов не использовалась ни разу при токенизации [корпуса стихотворений Пушкина](https://dataverse.pushdom.ru/dataset.xhtml?persistentId=doi:10.31860/openlit-2023.8-C005)

## Задача 1.1. 3 балла 
Обучите простую модель (можно RNN/n-gram/transformer) с вашим токенизатором.

## Задача 1.2. 2 балла 
Замените токенизатор GPT-2 на ваш (обученный на текстах, содержащих русский язык) и дообучите уже предобученный GPT-2 124M на нем.

## Задача 2. 5 баллов
Дообучите одну из следующих моделей генерировать анекдоты на русском языке:
- [Qwen-3-0.6B](https://huggingface.co/Qwen/Qwen3-0.6B)
- [Qwen-2.5-0.5B](https://huggingface.co/Qwen/Qwen2.5-0.5B)
- [gemma-3-270m](https://huggingface.co/google/gemma-3-270m)
- [SmolLM-360M](https://huggingface.co/HuggingFaceTB/SmolLM2-360M)

Для этого можете использовать SFT/RL. В качестве исходной модели можно брать Instruct-версию чекпойнта, за базовую версию (только Pretrain) вы получите +1 доп.балл.

Для сдачи этого задания вам необходимо подготовить файл со сгенерированными анекдотами в форммате txt, анекдоты должны находиться на отдельных строках.
Сдача задания будет проходить в виде соревнования-арены в специальном боте. Вам необходимо будет отправить подготовленный файл боту.Внимание! Можно отправить (успешно) только один файл! После небольшой проверки (премодерации) он будет добавлен в пул соревнующихся моделей.
Во время соревнования вы будете получать пары предсказаний и должны будете проголосовать за лучший из них. По количеству голосов будет определяться финальный рейтинг. Чем больше вы сравните анекдотов, тем более честным он будет :)
Соревнование закроется за 2 дня до зачета, защита этого задания будет включать только проверку ноутбуков заочно (без общения).
Для проверки вы должны закоммитить ноутбук c логами генерации, а также скрипты/ноутбуки, использованные для дообучения модели. 

Топ 25% получит +4 балла, топ-50% + 3 балла, топ-75% +1 балл
